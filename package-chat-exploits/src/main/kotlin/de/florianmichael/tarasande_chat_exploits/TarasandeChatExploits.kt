package de.florianmichael.tarasande_chat_exploits

import net.fabricmc.api.ClientModInitializer
import net.fabricmc.loader.api.FabricLoader
import net.tarasandedevelopment.tarasande.event.EventSuccessfulLoad
import net.tarasandedevelopment.tarasande.system.feature.modulesystem.ManagerModule
import de.florianmichael.tarasande_chat_exploits.module.ModuleNoChatContext
import de.florianmichael.tarasande_chat_exploits.module.ModulePrivateMsgDetector
import de.florianmichael.tarasande_chat_exploits.module.ModulePublicKeyKicker
import net.tarasandedevelopment.tarasande.TARASANDE_NAME
import su.mandora.event.EventDispatcher

class TarasandeChatExploits : ClientModInitializer {

    companion object {
        val tarasandeProtocolHackLoaded = FabricLoader.getInstance().isModLoaded("$TARASANDE_NAME-protocol-hack")
    }

    override fun onInitializeClient() {
        EventDispatcher.add(EventSuccessfulLoad::class.java) {
            ManagerModule.add(
                    ModuleNoChatContext(),
                    ModulePublicKeyKicker(),
                    ModulePrivateMsgDetector()
            )
        }
    }
}
